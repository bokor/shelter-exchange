<%= form_for (@animal), :html => { :multipart => :true } do |f| %>
	<ul>
		<li>
			<%= f.label :name, "Name <span class='req'>*</span>".html_safe, :class => "desc" %>
			<div><%= f.text_field :name, :class => "field text medium", :maxlength => 255, :placeholder => "Enter animal name" %></div>
			<%= has_error_message?(@animal, :name)%>
		</li>
		<li>
			<%= f.label :animal_type_id, "Type <span class='req'>*</span>".html_safe, :class => "desc" %>
			<div>
			<%= f.collection_select :animal_type_id, AnimalType.all, :id, :name, {:prompt => "Select one"}, {:class => "field select small" } %>
			</div>
			<%= has_error_message?(@animal, :animal_type_id)%>
		</li>
		<li id="breed_fields"> 
			<div id="primary_breed_field">
				<%= f.label :primary_breed, "Primary breed <span class='req'>*</span>".html_safe, :class => "desc" %>
				<div>
				<%= f.text_field :primary_breed, :autocomplete => :off, :class => "field text medium", :maxlength => 255 %>
				</div>
				<%= has_error_message?(@animal, :primary_breed)%>
			</div>
			<div id="is_mixed_breed_field">
				<span>
					<%= f.check_box :is_mix_breed, :class =>"field checkbox" %>
					<%= f.label :is_mix_breed, "Mixed Breed?", :class => "choice" %>
				</span>
				<%= has_error_message?(@animal, :is_mixed_breed)%>
			</div>
			<div id="secondary_breed_field">
				<%= f.label :secondary_breed, "Secondary breed", :class => "desc" %>
				<div>
				<%= f.text_field :secondary_breed, :autocomplete => :off, :class => "field text medium", :maxlength => 255 %>
				</div>
				<%= has_error_message?(@animal, :secondary_breed)%>
			</div>
		</li>
		<li>
			<%= f.label :animal_status_id, "Status <span class='req'>*</span>".html_safe, :class => "desc" %>
			<div>
			<%= f.collection_select :animal_status_id, AnimalStatus.all, :id, :name, {:prompt => "Select one"}, {:class => "field select small" } %>
			</div>
			<%= has_error_message?(@animal, :animal_status_id)%>
			<div id="reason_field">
				<%= f.label :status_history_reason, "Reason for the status change <span class='req'>*</span>".html_safe, :class => "desc" %>
				<%= f.text_field :status_history_reason, :class => "field text medium", :maxlength => 255 %>
			</div>
			<%= has_error_message?(@animal, :status_history_reason)%>
		</li>		
		<li>
			<%= f.label :sex, "Sex <span class='req'>*</span>".html_safe, :class => "desc" %>
			<div>
				<% SEX.each_with_index do |value, index| %>
					<span>
						<%= f.radio_button :sex, value, :class => "field radio" %>
						<%= f.label "sex_#{value}", value.humanize, :class => "choice" %>
					</span>
				<% end %>
			</div>
			<%= has_error_message?(@animal, :sex)%>
		</li>
		<li>
			<%= f.label :is_sterilized, "Has the Animal been Sterilized?", :class => "desc" %>
			<div>
				<span>
					<%= f.radio_button :is_sterilized, true, :class => "field radio" %>
					<%= f.label :is_sterilized, "Yes", :class => "choice" %>
				</span>
				<span>
					<%= f.radio_button :is_sterilized, false, :class => "field radio" %>
					<%= f.label :is_sterilized, "No", :class => "choice" %>
				</span>
			</div>
			<%= has_error_message?(@animal, :is_sterilized)%>
		</li>
		<li class="date">
			<%= f.label :date_of_birth, "Date of Birth (Est.)", :class => "desc" %>
			
			<span>
				<%= f.text_field :dob_month, :class => "field text", :maxlength => 2, :size => 2, :value => dob_value(:month, @animal)  %>
				<%= f.label :date_of_birth, "MM" %>
			</span> 
			<span class="symbol">/</span>
			<span>
				<%= f.text_field :dob_day, :class => "field text", :maxlength => 2, :size => 2, :value => dob_value(:day, @animal) %>
				<%= f.label :date_of_birth, "DD" %>
			</span>
			<span class="symbol">/</span>
			<span>
				<%= f.text_field :dob_year, :class => "field text", :maxlength => 4, :size => 4, :value => dob_value(:year, @animal) %>
				<%= f.label :date_of_birth, "YYYY" %>
			</span>
			<span>
				<%= image_tag "icon_calendar.png", :id => "date_of_birth_trigger", :class => "icon_calendar" %>
			</span>
			<span id="animal_date_of_birth_datepicker" class="calendar"></span>
			<%= has_error_message?(@animal, :date_of_birth)%>
		</li>
		<li>
			<%= f.label :weight, "Weight", :class => "desc" %>
			<div><%= f.text_field :weight, :class => "field text medium", :maxlength => 255 %></div>
			<%= has_error_message?(@animal, :weight)%>
		</li>
		<li>
			<%= f.label :size, "Size", :class => "desc" %>
			<div><%= f.text_field :size, :class => "field text medium", :maxlength => 255 %></div>
			<%= has_error_message?(@animal, :size)%>
		</li>
		<li>
			<%= f.label :color, "Color", :class => "desc" %>
			<div><%= f.text_field :color, :class => "field text medium", :maxlength => 255 %></div>
			<%= has_error_message?(@animal, :color)%>
		</li>
		<li>
			<%= f.label :microchip, "Microchip#", :class => "desc" %>
			<div><%= f.text_field :microchip, :class => "field text medium", :maxlength => 255 %></div>
			<%= has_error_message?(@animal, :microchip)%>
		</li>
		<li class="section">
			<section>
				<h3>Accommodation Info</h3>
				<div>Please select the location the animal sleeps at night!</div>
			</section>
		</li>
		<li>
			<div id="accommodation_info">
				<div id="accommodation_selected">
					<span><% if @animal.accommodation_id %><b><%= @animal.accommodation.name %></b><% end %></span>
					<a href="#accommodation_search_dialog" id="accommodation_search_link" toptions="width = 675, height = auto, type = dom, title = Select Accommodation, layout = quicklook, resizable = 0, shaded = 1, modal = 1"><% if @animal.accommodation_id %>Change<% else %>Search for accommodation<% end %></a>	
					
					<a href="#" id="accommodation_remove_link" onclick="Animals.removeAccommodation();">Remove</a>

				</div>
				<%= f.hidden_field :accommodation_id %>
			</div> 
			<%= has_error_message?(@animal, :accommodation_id)%>
		</li>
		<% if @current_shelter.is_kill_shelter %>
		<li class="section">
			<section>
				<h3>Euthanasia Details</h3>
				<div>Please feel in the correct information about the animal's euthanasia schedule.</div>
			</section>
		</li>
		<li class="date">
			<%= f.label :arrival_date, "Arrival Date <span class='req'>*</span>".html_safe, :class => "desc" %>
			
			<span>
				<%= f.text_field :arrival_date_month, :class => "field text", :maxlength => 2, :size => 2, :value => arrival_date_value(:month, @animal)  %>
				<%= f.label :arrival_date, "MM" %>
			</span> 
			<span class="symbol">/</span>
			<span>
				<%= f.text_field :arrival_date_day, :class => "field text", :maxlength => 2, :size => 2, :value => arrival_date_value(:day, @animal) %>
				<%= f.label :arrival_date, "DD" %>
			</span>
			<span class="symbol">/</span>
			<span>
				<%= f.text_field :arrival_date_year, :class => "field text", :maxlength => 4, :size => 4, :value => arrival_date_value(:year, @animal) %>
				<%= f.label :arrival_date, "YYYY" %>
			</span>
			<span>
				<%= image_tag "icon_calendar.png", :id => "arrival_date_trigger", :class => "icon_calendar" %>
			</span>
			<span id="animal_arrival_date_datepicker" class="calendar"></span>
			<%= has_error_message?(@animal, :arrival_date)%>
		</li>
		<li>
			<%= f.label :hold_time, "Hold time <span class='req'>*</span>".html_safe, :class => "desc" %>
			<div><%= f.text_field :hold_time, :class => "field text",  :maxlength => 3 %> days</div>
			<%= has_error_message?(@animal, :hold_time)%>
		</li>
		<li class="date">
			<%= f.label :euthanasia_scheduled, "Euthanasia Scheduled <span class='req'>*</span>".html_safe, :class => "desc" %>
			
			<span>
				<%= f.text_field :euthanasia_scheduled_month, :class => "field text", :maxlength => 2, :size => 2, :value => euthanasia_scheduled_value(:month, @animal)  %>
				<%= f.label :euthanasia_scheduled, "MM" %>
			</span> 
			<span class="symbol">/</span>
			<span>
				<%= f.text_field :euthanasia_scheduled_day, :class => "field text", :maxlength => 2, :size => 2, :value => euthanasia_scheduled_value(:day, @animal) %>
				<%= f.label :euthanasia_scheduled, "DD" %>
			</span>
			<span class="symbol">/</span>
			<span>
				<%= f.text_field :euthanasia_scheduled_year, :class => "field text", :maxlength => 4, :size => 4, :value => euthanasia_scheduled_value(:year, @animal) %>
				<%= f.label :euthanasia_scheduled, "YYYY" %>
			</span>
			<span>
				<%= image_tag "icon_calendar.png", :id => "euthanasia_scheduled_trigger", :class => "icon_calendar" %>
			</span>
			<span id="animal_euthanasia_scheduled_datepicker" class="calendar"></span>
			<%= has_error_message?(@animal, :euthanasia_scheduled)%>
		</li>
		
		<% end %>
		<li class="section">
			<section>
				<h3>Photo</h3>
				<div>Select a picture of the animal</div>
			</section>
		</li>
		<li id="photo" class="full">
			<%= render "photos/photo" %>
		</li>
		<li class="section">
			<section>
				<h3>Description</h3>
				<div>Please enter some nice stuff about this cute animal</div>
			</section>
		</li>
		<li>
			<%# f.label :description, "Description", :class => "desc" %>
			<div><%= f.text_area :description, :class => "field textarea medium" %></div>
			<%= has_error_message?(@animal, :description)%>
		</li>
		<li class="buttons">
			<%= f.submit button_text, :disable_with => "Submitting...", :class => 'button' %>
			<% unless action_name == "new" or action_name =="create" %>
				&nbsp;&nbsp;or&nbsp;&nbsp;
				<%= link_to "Cancel", animal_path(@animal) %>
			<% end %>
		</li>
	</ul>
<% end %>

<div id="accommodation_search_dialog" style="display:none;">
	<div class="wrapper">
		<h3>Filter by specific location:</h3>
		<%= form_for :accommodations, :url => { :action => :filter_by_type_location, :controller => :accommodations }, :remote => true, :html => { :id => "form_find_by_location", :method => :get } do |f| %>
			<%= collection_select(:location, :location_id, @current_shelter.locations.all, :id, :name, {:prompt => "All"}, 
				{ :name => "location_id", :onchange => "Accommodations.filterByTypeLocation();" } ) %><br /><br />
		<% end %>
		
		<div id="accommodations"></div>
	</div>
</div>