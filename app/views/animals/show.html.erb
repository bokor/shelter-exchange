<%= title "#{@animal.name} (#{@animal.id})" %>

<%= content_for :javascripts do %>
	<%= javascript_include_tag "animals/animals", "tasks/tasks", "date", :cache => "cache/application/animals-show" %>
<% end %>

<%= content_for :page_content do %>
	<div class="page_heading blue_background">
		<table class="animal">
			<tr>
				<td>
					<h1><%= @animal.name %><span>#<%= @animal.id %></span></h1>
				</td>
				<td class="action_links">
					<%= link_to "Create new animal", new_animal_path %>&nbsp;&nbsp;|&nbsp;&nbsp;
					<%= link_to "Edit", edit_animal_path(@animal)%>&nbsp;&nbsp;|&nbsp;&nbsp;
					<%= link_to "Delete", @animal, :confirm => "Are you sure?", :method => :delete %>
				</td>
			</tr>
			<tr>
				<td>
					<p><%= @animal.animal_type.name %>:  <%= format_breed(@animal.is_mix_breed, @animal.primary_breed, @animal.secondary_breed) %></p>
				</td>
				<td class="right">
					<p><%= @animal.animal_status.name %></p>
				</td>
			</tr>
		</table>
	</div>
	
	<div class="page_content">
		 
		<table class="animal_details">
			<tr>
				<td class="metadata">
					<h3>Details:</h3>
					<ul>
						<li><p><b>Weight:</b> <%= @animal.weight %></p></li>
						<li><p><b>Age:</b> <%= @animal.age %></p></li>
						<li><p><b>MChip:</b> <%= @animal.chip_id %></p></li>
						<li><p><b>Color:</b> <%= @animal.color %></p></li>
						<li><p><b>Sex:</b> <%= @animal.sex %> <% if @animal.is_sterilized %>(Sterilized)<% end %></p></li>
					</ul>
					
					<h3>Accommodation:</h3>
					<ul>
						<li><p><b>Name:</b> <%= @animal.accommodation.name unless @animal.accommodation.blank? %></p></li>
						<li><p><b>Location:</b> <%= @animal.accommodation.location.name if @animal.accommodation && @animal.accommodation.location %></p></li>
					</ul>
					
					
				</td>
				<td class="image">
			    	<a href="<%= @animal.photo.url(:original) %>" toptions="noGroup = 1, title = Picture of <%= @animal.name %>, layout = quicklook" tu_group="null"><%= image_tag @animal.photo.url(:medium) %></a>
			    </td>
			</tr>
		</table>
		
		<table class="description">
			<tr>
				<td>
					<h3>Description:</h3>
					<p><%= @animal.description %></p>
				</td>
			</tr>
		</table>
		
		<% if @current_shelter.is_kill_shelter %>
		<table class="euthanasia_info">
			<tr>
				<td>
					<h3>Euthanasia Info:</h3>
					<ul>
						<li><p><b>Arrival Date:</b> <span class="date"><%= format_date(:default, @animal.arrival_date) %></span></p></li>
						<li><p><b>Hold time:</b> <span class="date"><%= @animal.hold_time %> days</span></p></li>
						<li><p><b>Euthanasia Date:</b> <span class="red_date"><%= format_date(:default, @animal.euthanasia_scheduled) %></span></p></li>
					</ul>
				</td>
			</tr>
		</table>
		<% end %>

		
	</div>
	
	<div class="note_filters yellow_background">
		<h2>Notes</h2>
		<div class="links">
			<%= link_to 'All', filter_notes_animals_path(:id => @animal.id), :remote => true, :id => "all_notes_link" %>&nbsp;|&nbsp;
			<%= link_to 'General', filter_notes_animals_path(:filter => "General", :id => @animal.id), :remote => true, :id => "general_notes_link" %>&nbsp;|&nbsp;
			<%= link_to 'Medical', filter_notes_animals_path(:filter => "Medical", :id => @animal.id),  :remote => true,:id => "medical_notes_link" %>&nbsp;|&nbsp;
			<%= link_to 'Behavioral', filter_notes_animals_path(:filter => "Behavioral", :id => @animal.id), :remote => true,:id => "behavioral_notes_link" %>
		</div>
	</div>
	
	<div id="notes" class="page_content">
		<%= render @animal.notes %>
	</div>

<% end %>

<%= content_for :sidebar do %>

	<ul class="model_actions">
		<li><%= link_to 'Add Alert', "#", :id => "add_alert_link", :class => "button" -%></li>
		<li><%= link_to 'Add Note', "#", :id => "add_note_link", :class => "button" -%></li>
		<li><%= link_to 'Add Task', "#", :id => "add_task_link", :class => "button" -%></li>
	</ul>
	
	<div id="create_alert">
		<h2>Add an alert for <%= @animal.name %></h2>
		<div id="alert_errors"></div>
		<%= form_for ([@animal, Alert.new]), :remote => true do |f| %>
			<%= render :partial => "alerts/form", :locals => { :f => f } %>
		    <div class="actions">
				<%= f.submit "Create Alert", :disable_with => "Submitting...", :id => "create_alert_button", :class => "button"  %>
				&nbsp;or&nbsp;<%= link_to "Cancel", "#", :id => "cancel_alert" -%>
			</div>
		<% end %>
	</div>
	
	<div id="create_note">
		<h2>Add a note for <%= @animal.name %></h2>
		<div id="note_errors"></div>
		<%= form_for ([@animal, Note.new]), :remote => true do |f| %>
			<%= render :partial => "notes/form", :locals => { :f => f } %>
		    <div class="actions">
				<%= f.submit "Create Note", :disable_with => "Submitting...", :id => "create_note_button", :class => "button"  %>
				&nbsp;or&nbsp;<%= link_to "Cancel", "#", :id => "cancel_note" -%>
			</div>
		<% end %>
		<div id="another_note_category"></div>
	</div>
	
	<div id="create_task">
		<h2>Add a task for <%= @animal.name %></h2>
		<div id="task_errors"></div>
		<%= form_for ([@animal, Task.new]), :remote => true do |f| %>
			<%= render :partial => "tasks/form", :locals => { :f => f } %>
		    <div class="actions">
				<%= f.submit "Create Task", :disable_with => "Submitting...", :id => "create_task_button", :class => "button"  %>
				&nbsp;or&nbsp;<%= link_to "Cancel", "#", :id => "cancel_task" -%>
			</div>
		<% end %>
	</div>
	
	<div id="animal_alerts">
		<h2>Alerts</h2>
		<div id="alerts" class="alert_list">
			<%= render :partial => 'alerts/alert', :as => :alert, :collection => @alerts %>
		</div>
	</div>

	<div id="animal_tasks">
		<h2>Tasks</h2>
		<div id="overdue_tasks_section" class="<%= "no_tasks" if @overdue_tasks.blank? %>">
			<h3>Overdue</h3>
			<div id="overdue_tasks" class="task_list">
				<%= render :partial => 'tasks/task', :collection => @overdue_tasks, :locals => { :animal_link => false } %>
			</div>
		</div>

		<div id="today_tasks_section" class="<%= "no_tasks" if @today_tasks.blank? %>">
			<h3>Today</h3>
			<div id="today_tasks" class="task_list">
				<%= render :partial => 'tasks/task', :collection => @today_tasks, :locals => { :animal_link => false } %>
			</div>
		</div>

		<div id="tomorrow_tasks_section" class="<%= "no_tasks" if @tomorrow_tasks.blank? %>">
			<h3>Tomorrow</h3>
			<div id="tomorrow_tasks" class="task_list">
				<%= render :partial => 'tasks/task', :collection => @tomorrow_tasks, :locals => { :animal_link => false } %>
			</div>
		</div>

		<div id="later_tasks_section" class="<%= "no_tasks" if @later_tasks.blank? %>">
			<h3>Later</h3>
			<div id="later_tasks" class="task_list">
				<%= render :partial => 'tasks/task', :collection => @later_tasks, :locals => { :animal_link => false } %>
			</div>
		</div>
	</div>

<% end %>
	
