<% if @task.errors.any? %>
	$('#task_errors').html( "<%= escape_javascript(render 'global/error_messages', :target => @task) %>" );
<% else %>
	<% if @changed %>
		$('#edit_task_<%=@task.id%>').slideToggle(3000);
		$('#task_<%=@task.id%>').fadeOut(1500);
		$('#edit_task_<%=@task.id%>').delay(500).remove();
		$('#task_<%=@task.id%>').delay(500).remove();
		// Manipulate Specific Section's Content
		<% due_section = find_due_section %>
		$('#<%=due_section %>_tasks_section').removeClass("no_task");
		$('#<%=due_section %>_tasks_section').fadeIn(1500);
		$('#<%=due_section %>_tasks').prepend("<%= escape_javascript(render @task) %>"); //probably append instead of prepend
		$("#<%=due_section %>_tasks .task").first().effect("highlight", {}, 1000);
		
	<% else %>
		$('#edit_task_<%=@task.id%>').slideToggle();
		$('#task_<%=@task.id%>').replaceWith( "<%= escape_javascript(render @task) %>" );
		$('#task_<%=@task.id%>').show().effect("highlight", {}, 1000);
	<% end %>
	$('#task_errors').html("");
<% end %>
<% flash.discard %>

// Remove any sections where their are no more items in that section
if ($("#overdue_tasks > div").size() == 0) {  
	$('#overdue_tasks_section').addClass("no_tasks");
	$('#overdue_tasks_section').fadeOut(1500);
} 
if ($("#today_tasks > div").size() == 0) {  
	$('#today_tasks_section').addClass("no_tasks");
	$('#today_tasks_section').fadeOut(1500);
}
if ($("#tomorrow_tasks > div").size() == 0) {  
	$('#tomorrow_tasks_section').addClass("no_tasks");
	$('#tomorrow_tasks_section').fadeOut(1500);
}
if ($("#later_tasks > div").size() == 0) {  
	$('#later_tasks_section').addClass("no_tasks");
	$('#later_tasks_section').fadeOut(1500);
}
