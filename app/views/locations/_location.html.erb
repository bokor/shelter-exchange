<div id="location_<%= location.id %>" class="location<% if location.animals.count == location.max_capacity %> over_capacity<% end %>">
	
	<h2><%= location.name %>
		<span class="animal_type"><%= location.animal_type.name if location.animal_type.name %></span>
		<span class="select_link"><% if location.animals.count != location.max_capacity %><%= link_to "Select", "#", :onclick => "Animals.selectLocation('#{location.id}','#{location.name}');" %><% else %>Location Full<% end %></span>
	</h2>
		
	<div class="animal_count">
		<span class="space_available">Space Available: <%= location.max_capacity - location.animals.count %></span>
		<span class="view_details" onclick="$('#location_details_<%= location.id %>').slideToggle();">View Details</span>
	</div>
	
	<h3>Tags:</h3>
	
	<ul id="location_tags_<%= location.id %>" class="tags">
		<%= render :partial => "tags/tag", :collection => location.tags %>
	</ul>
	
	<span id="tag_link_<%= location.id %>">
		<a href="#" onclick="$('#tag_form_<%= location.id %>').show();$('#tag_link_<%= location.id %>').hide();return false;">Add Tags</a>
	</span>
	
	<div id="tag_form_<%= location.id %>" style="display:none;">
		<%= form_for :tags, :url => { :controller => :tags, :action => :add_tag, :id => location.id }, :remote => true, :html => { :id => "form_add_tags", :class => "add_tags", :method => :get } do |f| %>
	    <!-- :locations, :url => { :action => :find_by, :id => location.id }, :remote => true, :html => { :id => "form_create_tags", :class => "create_tags", :method => :get } -->
		<p><%= label_tag "add_tag", "Enter one tag at a time" %><br />
		<%= text_field_tag "add_tag", "", :onkeyup => "Tags.autoComplete(this);"  %></p>
		<p class="add_tag_links">
		<%= f.submit "Add Tag", :disable_with => "Submitting...", :class => "button" %>
		or
		<%= link_to 'Cancel', '#', :onclick => "$('#tag_link_#{location.id}').show();$('#tag_form_#{location.id}').hide();return false;"  %>
		</p>
		<% end %>
	</div>

	<div id="location_details_<%= location.id %>" style="display:none;">
		<% if location.animals.size > 0 %>
		<table class="list">
			<% location.animals.each do |animal| %>
			<tr>
				<td class="image">
					<%= link_to image_tag(animal.photo.url(:thumb)), animal_path(animal)  %>
				</td>
				<td class="details">
					<p><%= link_to animal.name, animal %></p>
					<p><% if animal.sex %><%= animal.sex %><% end %> <% if animal.is_sterilized %>(Sterilized)<% end %></p>
					<p><b><%= animal.animal_status.name %></b></p>
				</td>
			</tr>
			<% end %>
		</table>
		<% else %>
			<h3>No animals in this location</h3>
		<% end %>
		<span class="action_links">
			<%= link_to "Edit", edit_location_path(location), :remote => true %>&nbsp;&nbsp;
			<%= link_to "Delete", location, :method => :delete, :confirm => "Are you sure?", :remote => true %>
		</span>
	</div>

</div>